# V2: Requisiti per la Privace e l'archiviazione dei Dati

## Obiettivo della Sezione

La protezione dei dati sensibili, come le credenziali dell'utente e le informazioni private, è un aspetto fondamentale della sicurezza mobile. In primo luogo, i dati sensibili possono essere involontariamente esposti ad altre applicazioni in esecuzione sullo stesso dispositivo se i meccanismi del sistema operativo, come l'IPC, vengono utilizzati in modo improprio. I dati possono anche trapelare involontariamente nel cloud storage, nei backup o nella cache della tastiera. Inoltre, i dispositivi mobili possono essere smarriti o rubati più facilmente rispetto ad altri tipi di dispositivi, quindi l'accesso fisico da parte di un avversario è uno scenario più probabile. In questo caso, è possibile implementare ulteriori protezioni per rendere più difficile il recupero dei dati sensibili.

Si noti che, essendo il MASVS incentrato sulle applicazioni, non copre le politiche a livello di dispositivo, come quelle applicate dalle soluzioni MDM. Incoraggiamo l'uso di tali politiche in un contesto aziendale per migliorare ulteriormente la sicurezza dei dati.

### La definizione di Dati Sensibili

I dati sensibili nel contesto del MASVS si riferiscono sia alle credenziali dell'utente che a qualsiasi altro dato considerato sensibile nel contesto specifico, come ad esempio:

- Informazioni di identificazione personale (PII) che possono essere utilizzate per il furto di identità:  Numeri di previdenza sociale, numeri di carte di credito, numeri di conti bancari, informazioni sanitarie;
- Dati altamente sensibili che, se compromessi, potrebbero causare danni alla reputazione e/o costi finanziari: Informazioni contrattuali, informazioni coperte da accordi di non divulgazione, informazioni gestionali;
- Tutti i dati che devono essere protetti per legge o per motivi di conformità.

<!-- \pagebreak -->
## Requisiti per la Verifica di Sicurezza

La maggior parte dei problemi di divulgazione dei dati può essere evitata seguendo semplici regole. La maggior parte dei controlli elencati in questo capitolo sono obbligatori per tutti i livelli di verifica.

| # | MSTG-ID | Description | L1 | L2 |
| -- | ---------- | ---------------------- | - | - |
| **2.1** | MSTG-STORAGE-1 | Le strutture di archiviazione delle credenziali di sistema devono essere utilizzate per archiviare dati sensibili, come PII, credenziali utente o chiavi crittografiche. | x | x |
| **2.2** | MSTG-STORAGE-2 | Nessun dato sensibile deve essere memorizzato al di fuori del container dell'applicazione o delle strutture di archiviazione delle credenziali di sistema. | x | x |
| **2.3** | MSTG-STORAGE-3 | Nessun dato sensibile viene scritto nei log delle applicazioni. | x | x |
| **2.4** | MSTG-STORAGE-4 | Nessun dato sensibile viene condiviso con terzi, a meno che non sia una parte necessaria dell'architettura. | x | x |
| **2.5** | MSTG-STORAGE-5 | La cache della tastiera è disattivata per gli input di testo che elaborano dati sensibili. | x | x |
| **2.6** | MSTG-STORAGE-6 | I meccanismi IPC non espongono dati sensibili. | x | x |
| **2.7** | MSTG-STORAGE-7 | L'interfaccia utente non espone dati sensibili, come password o pin. | x | x |
| **2.8** | MSTG-STORAGE-8 | No sensitive data is included in backups generated by the mobile operating system. |   | x |
| **2.9** | MSTG-STORAGE-9 | I backup generati dal sistema operativo mobile non contengono dati sensibili. |  | x |
| **2.10** | MSTG-STORAGE-10 | L'applicazione non trattiene in memoria i dati sensibili più del necessario e la memoria viene cancellata esplicitamente dopo l'uso. |  | x |
| **2.11** | MSTG-STORAGE-11 | L'applicazione applica un criterio minimo di sicurezza per l'accesso al dispositivo, ad esempio richiedendo all'utente di impostare un codice di accesso al dispositivo. |  | x |
| **2.12** | MSTG-STORAGE-12 | L'applicazione informa l'utente sui tipi di informazioni di identificazione personale trattate e sulle migliori pratiche di sicurezza che l'utente dovrebbe seguire nell'utilizzo dell'applicazione. | x | x |
| **2.13** | MSTG-STORAGE-13 | Nessun dato sensibile deve essere memorizzato localmente sul dispositivo mobile. I dati devono invece essere recuperati da un endpoint remoto quando necessario e conservati solo in memoria. |  | x |
| **2.14** | MSTG-STORAGE-14 | Se i dati sensibili devono ancora essere archiviati localmente, devono essere crittografati utilizzando una chiave derivata dall'archiviazione supportata da hardware che richiede l'autenticazione. |  | x |
| **2.15** | MSTG-STORAGE-15 | La memoria locale dell'app deve essere cancellata dopo un numero eccessivo di tentativi di autenticazione falliti. |  | x |

## Riferimenti

La OWASP Mobile Application Security Testing Guide fornisce istruzioni dettagliate per la verifica dei requisiti elencati in questa sezione.

- Android: Testing Data Storage - <https://github.com/OWASP/owasp-mastg/blob/master/Document/0x05d-Testing-Data-Storage.md>
- iOS: Testing Data Storage - <https://github.com/OWASP/owasp-mastg/blob/master/Document/0x06d-Testing-Data-Storage.md>

Per ulteriori informazioni, vedere anche:

- OWASP Mobile Top 10: M1 (Improper Platform Usage) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage>
- OWASP Mobile Top 10: M2 (Insecure Data Storage) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage>
- CWE 117 (Improper Output Neutralization for Logs) - <https://cwe.mitre.org/data/definitions/117.html>
- CWE 200 (Information Exposure) - <https://cwe.mitre.org/data/definitions/200.html>
- CWE 276 (Incorrect Default Permissions) - <https://cwe.mitre.org/data/definitions/276.html>
- CWE 311 (Missing Encryption of Sensitive Data) - <https://cwe.mitre.org/data/definitions/311.html>
- CWE 312 (Cleartext Storage of Sensitive Information) - <https://cwe.mitre.org/data/definitions/312.html>
- CWE 316 (Cleartext Storage of Sensitive Information in Memory) - <https://cwe.mitre.org/data/definitions/316.html>
- CWE 359 (Exposure of Private Information ('Privacy Violation')) - <https://cwe.mitre.org/data/definitions/359.html>
- CWE 522 (Insufficiently Protected Credentials) - <https://cwe.mitre.org/data/definitions/522.html>
- CWE 524 (Information Exposure Through Caching) - <https://cwe.mitre.org/data/definitions/524.html>
- CWE 530 (Exposure of Backup File to an Unauthorized Control Sphere) - <https://cwe.mitre.org/data/definitions/530.html>
- CWE 532 (Information Exposure Through Log Files) - <https://cwe.mitre.org/data/definitions/532.html>
- CWE 534 (Information Exposure Through Debug Log Files) - <https://cwe.mitre.org/data/definitions/534.html>
- CWE 634 (Weaknesses that Affect System Processes) - <https://cwe.mitre.org/data/definitions/634.html>
- CWE 798 (Use of Hard-coded Credentials) - <https://cwe.mitre.org/data/definitions/798.html>
- CWE 921 (Storage of Sensitive Data in a Mechanism without Access Control) - <https://cwe.mitre.org/data/definitions/921.html>
- CWE 922 (Insecure Storage of Sensitive Information) - <https://cwe.mitre.org/data/definitions/922.html>
